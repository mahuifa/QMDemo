# Qt - Webæ··åˆå¼€å‘Demo

[toc]

---

## 1ã€è¯´æ˜Ž

|       ç±»å       | åŠŸèƒ½                                                       |
| :--------------: | ---------------------------------------------------------- |
|     minimal      | ä½¿ç”¨QWebEngineViewåŠ è½½æ˜¾ç¤ºWebé¡µé¢çš„æœ€å°ç¤ºä¾‹1               |
|     minimal2     | ä½¿ç”¨QWebEngineViewåŠ è½½æ˜¾ç¤ºWebé¡µé¢çš„æœ€å°ç¤ºä¾‹2               |
|  authorization   | ä½¿ç”¨QWebEnginePageæ‰“å¼€æ‘„åƒå¤´æ¼”ç¤ºæƒé™ç®¡ç†                   |
|   channelDemo    | ä½¿ç”¨QtWebChannelå®žçŽ°Qtä¸ŽWebé€šä¿¡äº¤äº’ï¼ˆç®€å•ç¤ºä¾‹ï¼‰            |
|   channelDemo2   | ä½¿ç”¨QtWebChannelå®žçŽ°Qtä¸ŽWebé€šä¿¡äº¤äº’ï¼ˆè¿›é˜¶åŠŸèƒ½ï¼‰            |
| channelWebSocket | ä½¿ç”¨QWebSocketä½œä¸ºQWebChannelé€šä¿¡æ•°æ®ä¼ è¾“æŽ¥å£              |
|      QtJson      | ä½¿ç”¨Qtå†…ç½®jsonåº“è¯»å†™jsonç¤ºä¾‹                               |
|    ChatClient    | ä½¿ç”¨QWebSocketå®žçŽ°çš„ç®€å•å®¢æˆ·ç«¯ç¨‹åº                         |
|    ChatServer    | ä½¿ç”¨QWebSocketServerå®žçŽ°çš„ç®€å•æœåŠ¡ç«¯ç¨‹åº                   |
|  ChatClientHtml  | å‰ç«¯ç½‘é¡µç‰ˆæœ¬WebSocketå®¢æˆ·ç«¯ç¨‹åºï¼ˆhtml+css+javascriptå®žçŽ°ï¼‰ |
|     LoadWeb      | ä½¿ç”¨CEFåŠ è½½ç½‘é¡µçš„ç®€å•ç¤ºä¾‹ç¨‹åº                              |

 


## 2ã€ç›¸å…³åšå®¢

|                           ç›¸å…³åšå®¢                           |
| :----------------------------------------------------------: |
| ðŸ‘‰[CSDN](https://blog.csdn.net/qq_43627907/category_12140943.html)ðŸ‘ˆ |




## 3ã€å®žçŽ°æ•ˆæžœ

### 1.1 minimal

> 1. ä¿ç•™æœ€ç®€å•åŠŸèƒ½ï¼ŒåŽ»æŽ‰ä¸æ˜“äºŽç†è§£çš„åŠŸèƒ½ï¼›                 
> 2. åˆ†åˆ«æ¼”ç¤ºäº†åŠ è½½ç½‘ç»œåœ°å€ã€èµ„æºæ–‡ä»¶ä¸­çš„Htmlæ–‡ä»¶ï¼Œæœ¬åœ°htmlçš„æ–¹å¼ï¼› 
> 3. è¯¦ç»†çš„æ³¨é‡Šï¼Œå¯¹åˆå­¦è€…æ›´å‹å¥½ã€‚                      

![image-20221211210252527](Web.assets/image-20221211210252527.png)



### 1.2 minimal2

> 1. ä½¿ç”¨QWebEngineViewåŠ è½½æ˜¾ç¤ºWebé¡µé¢çš„æœ€å°ç¤ºä¾‹2
> 2. ä¿ç•™æœ€ç®€å•åŠŸèƒ½ï¼ŒåŽ»æŽ‰ä¸æ˜“äºŽç†è§£çš„åŠŸèƒ½ï¼›                                             
> 3. åˆ†åˆ«æ¼”ç¤ºäº†ã€QWebEngineView::setHtmlã€‘ã€QWebEngineView::setContentã€‘çš„ä½¿ç”¨æ–¹æ³•ï¼›
> 4. è¯¦ç»†çš„æ³¨é‡Šï¼Œå¯¹åˆå­¦è€…æ›´å‹å¥½ã€‚                                                  

* setHtmlåŠ è½½htmlä»£ç 

  ![image-20221214171041497](Web.assets/image-20221214171041497.png)

* setHtmlåŠ è½½htmlä»£ç ï¼Œå¹¶é€šè¿‡ç›¸å¯¹è·¯å¾„å¼•ç”¨å‚æ•°2çš„åœ°å€ä¸­çš„å›¾ç‰‡

  ![image-20221214171147965](Web.assets/image-20221214171147965.png)



### 1.3 authorization

> 1. ä½¿ç”¨QWebEnginePageæœ‰æ—¶éœ€è¦æƒé™ï¼Œä¾‹å¦‚æ‰“å¼€æ‘„åƒå¤´ã€éº¦å…‹é£Žï¼›
> 2. è¿™é‡Œæ¼”ç¤ºäº†æ€Žä¹ˆå®žçŽ°æŽˆæƒåŠŸèƒ½ï¼›                     
> 3. åˆ†åˆ«å±•ç¤ºäº†æ‰“å¼€ã€ç½‘ç»œåœ°å€æŽˆæƒã€‘å’Œæ‰“å¼€ã€æœ¬åœ°htmlæŽˆæƒã€‘ã€‚          

![image-20221215174224272](Web.assets/image-20221215174224272.png)



### 1.4 channelDemo

> 1. ä½¿ç”¨QtWebChannelå®žçŽ°Qtä¸ŽWebåŒå‘äº¤äº’ï¼›       
> 2. æž„å»ºåŽå°†htmlã€cssã€jsæ–‡ä»¶è‡ªåŠ¨æ‹·è´åˆ°å¯æ‰§è¡Œç¨‹åºè·¯å¾„ä¸‹ï¼›
> 3. webç•Œé¢å’Œqtç•Œé¢å®žçŽ°åŒå‘é€šä¿¡ã€‚             

![channelDemo-tuya](Web.assets/channelDemo-tuya.gif)



### 1.5 QtJson

> 1. ä½¿ç”¨Qtå†…ç½®jsonåº“è¯»å†™jsonç¤ºä¾‹                             
> 2. å®žçŽ°ç”Ÿæˆjsonæ•°æ®ï¼Œæ’å…¥jsonæ•°ç»„ã€jsonå¯¹è±¡ä»¥åŠå„ç§jsonæ”¯æŒçš„æ•°æ®ç±»åž‹ï¼›
> 3. å°†jsonæ•°æ®ä¿å­˜åˆ°jsonæ–‡ä»¶ä¸­ï¼›                        
> 4. ä»Žjsonæ–‡ä»¶ä¸­è¯»å–jsonæ•°æ®ï¼Œå¹¶ä½¿ç”¨ã€é€’å½’ã€‘çš„æ–¹å¼è§£æžjsonæ•°æ®ã€‚      

![image-20221215175419479](Web.assets/image-20221215175419479.png)



### 1.6 channelDemo2

ç”¨QtWebChannelå®žçŽ°Qtä¸ŽWebåŒå‘äº¤äº’ï¼ˆ2ï¼‰ï¼Œè¿›é˜¶åŠŸèƒ½ ï¼›

> 1. 
>    æž„å»ºåŽå°†htmlã€cssã€jsæ–‡ä»¶è‡ªåŠ¨æ‹·è´åˆ°å¯æ‰§è¡Œç¨‹åºè·¯å¾„ä¸‹ï¼›                 
> 2. webç•Œé¢å’Œqtç•Œé¢å®žçŽ°åŒå‘é€šä¿¡ï¼›                               
> 3. ç”±äºŽQWebChannelä¼ é€’æ•°æ®åªæœ‰å¯ä»¥è½¬æ¢ä¸ºã€JSONçš„æ•°æ®ç±»åž‹ã€‘æ‰å¯ä»¥ä¼ é€’ï¼Œå…¶å®ƒç±»åž‹æ— æ³•ä¼ é€’ï¼Œä¾‹å¦‚QByteArrayè¿™äº›JSONä¸æ”¯æŒçš„æ•°æ®ç±»åž‹ï¼Œè¿™é‡Œæ¼”ç¤ºäº†å¯ä»¥ä¼ é€’çš„æ‰€æœ‰æ•°æ®ç±»åž‹çš„ä½¿ç”¨æ–¹å¼ï¼›                         
> 4. Webç•Œé¢ä¸­javascriptç›´æŽ¥è¯»å–Qtä¸­æ³¨å†Œå¯¹è±¡ä½¿ç”¨Q_PROPERTYå®šä¹‰çš„ã€å±žæ€§å€¼ã€‘ï¼›
> 5. Webç•Œé¢ä¸­javascriptç›´æŽ¥è¯»å–Qtä¸­æ³¨å†Œå¯¹è±¡ä½¿ç”¨ä½¿ç”¨Q_ENUMæ ‡è®°çš„ã€æžšä¸¾ã€‘ï¼›   
> 6. å®šä¹‰ä¸€ä¸ªå¸¦æœ‰è¿”å›žå€¼çš„æ§½å‡½æ•°ï¼Œjavascriptè°ƒç”¨è¯¥å‡½æ•°åŽå¯ä»¥èŽ·å–ã€è¿”å›žå€¼ã€‘ï¼›        

![image-20221216124021490](Web.assets/image-20221216124021490.png)



### 1.7 ChatClient

QWebSocketå®¢æˆ·ç«¯ç®€å•ç¤ºä¾‹   

> 1. 
>    å®žçŽ°è¿žæŽ¥ã€æ–­å¼€è¿žæŽ¥ã€æ•°æ®å‘é€ã€æ•°æ®æŽ¥æ”¶æ˜¾ç¤ºåŠŸèƒ½ï¼›

![image-20221217210219249](Web.assets/image-20221217210219249.png)



### 1.8 ChatServer

QWebSocketServeræœåŠ¡ç«¯ç®€å•ç¤ºä¾‹

> 1. ä½¿ç”¨QWebSocketServeråˆ›å»ºä¸€ä¸ªæœåŠ¡ç«¯ï¼Œä½¿ç”¨ã€éžå®‰å…¨æ¨¡å¼ã€‘;  
> 2. å°†æ‰€æœ‰è¿žæŽ¥çš„å®¢æˆ·ç«¯åŠ å…¥åˆ—è¡¨ï¼Œå®žçŽ°æœåŠ¡ç«¯åŒæ—¶å‘æ‰€æœ‰å®¢æˆ·ç«¯å‘é€ä¿¡æ¯ï¼›      
> 3. å®žçŽ°å°†å®¢æˆ·ç«¯ä¼ é€’è¿‡æ¥çš„ä¿¡æ¯è½¬å‘ç»™å…¶å®ƒæ‰€æœ‰å®¢æˆ·ç«¯ï¼›              
> 4. å®žçŽ°åœ¨å…³é—­æ—¶é‡Šæ”¾æ‰€æœ‰å®¢æˆ·ç«¯åŠŸèƒ½ã€‚                      

![image-20221217210336065](Web.assets/image-20221217210336065.png)



### 1.9 ChatClientHtml

å‰ç«¯ç½‘é¡µç‰ˆæœ¬WebSocketå®¢æˆ·ç«¯ç¨‹åºï¼ˆhtml+css+javascriptå®žçŽ°ï¼‰

> 1. ä½¿ç”¨htmlç¼–å†™ç•Œé¢ã€cssè®¾ç½®æ ·å¼ã€javascriptå®žçŽ°webSocketå®¢æˆ·ç«¯ç¨‹åºï¼›
> 2. å°†htmlã€cssã€jsæ–‡ä»¶åˆ†å¼€ç¼–å†™ï¼Œä¾¿äºŽé˜…è¯»ï¼›                      
> 3. ç¨‹åºç¼–è¯‘åŽè‡ªåŠ¨å°†htmlæ–‡ä»¶å¤¹æ‹·è´åˆ°å¯æ‰§è¡Œç¨‹åºå½“å‰è·¯å¾„ï¼›                  
> 4. å¯ä»¥ç›´æŽ¥ç‚¹å‡»chatClient.htmlæ–‡ä»¶è¿è¡Œå®¢æˆ·ç«¯ç¨‹åºï¼›               
> 5. ä¹Ÿå¯ä»¥åœ¨ç¨‹åºç¼–è¯‘è¿è¡ŒåŽä½¿ç”¨QDesktopServicesè‡ªåŠ¨æ‰“å¼€htmlæ–‡ä»¶ã€‚      

![image-20221219154051957](Web.assets/image-20221219154051957.png)



### 1.10 channelWebSocket

ä½¿ç”¨QWebSocketä½œä¸ºQWebChannelé€šä¿¡æ•°æ®ä¼ è¾“æŽ¥å£ï¼Œå®žçŽ°ä¸Žè¿œç¨‹ç½‘é¡µäº¤äº’åŠŸèƒ½

> 1. æž„å»ºåŽå°†htmlã€cssã€jsæ–‡ä»¶è‡ªåŠ¨æ‹·è´åˆ°å¯æ‰§è¡Œç¨‹åºAè·¯å¾„ä¸‹ï¼›      
> 2. ä½¿ç”¨QWebSocketä½œä¸ºQWebChannelé€šä¿¡æŽ¥å£ï¼›        
> 3. é€šè¿‡QWebEngineViewåœ¨Qtç•Œé¢ä¸­åµŒå…¥Webç½‘é¡µï¼›        
> 4. ä¸€é”®è°ƒç”¨æµè§ˆå™¨æ‰“å¼€htmlæ–‡ä»¶ï¼›                      
> 5. åŸºäºŽWebSocketã€QWebChannel.jså®žçŽ°ç½‘é¡µå’ŒQté€šä¿¡åŠŸèƒ½ï¼›
> 6. åŒæ—¶æ¼”ç¤ºäº†Qtå’ŒåµŒå…¥ç½‘é¡µç•Œé¢ã€æµè§ˆå™¨ç½‘é¡µç•Œé¢é€šä¿¡åŠŸèƒ½;           
> 7. æ”¯æŒä¸€ä¸ªæœåŠ¡ç«¯ä¸Žå¤šä¸ªå®¢æˆ·ç«¯Webç•Œé¢è¿›è¡Œé€šä¿¡äº¤äº’ï¼Œå°†WebSocketæœåŠ¡ç«¯å°è£…åœ¨QWebChannelå†…éƒ¨ï¼Œä¸€ä¸ªWebChannelå¯¹åº”ä¸€ä¸ªæœåŠ¡ç«¯ã€å¤šä¸ªå®¢æˆ·ç«¯ã€‚

![image-20221219154652982](Web.assets/image-20221219154652982.png)



### 1.10 LoadWeb

* å·¥ç¨‹è¯´æ˜Ž

  > å°†CEFåº“åµŒå…¥Qtä¸­åŠ è½½ç½‘é¡µçš„ç®€å•ç¤ºä¾‹ç¨‹åºï¼›
  >
  > ä½¿ç”¨çš„æ˜¯å°è£…è¿‡çš„QCefViewåº“ï¼›

* ç¼–è¯‘è¯´æ˜Ž

  > åœ¨ä¸»å·¥ç¨‹CefExamples.proå’Œå„å­å·¥ç¨‹ä¸­é€šè¿‡å˜é‡ã€CefPathã€‘è®¾ç½®è‡ªå·±çš„CEFåº“æ–‡ä»¶è·¯å¾„ï¼Œå¦‚æžœä¸è®¾ç½®åˆ™ä¸ä¼šç¼–è¯‘å½“å‰å·¥ç¨‹æ–‡ä»¶ï¼›
  >
  > æž„å»ºæ—¶ä¼šè¾“å‡ºå¦‚å›¾ä¿¡æ¯ï¼Œä¸ºä¸åŒç¼–è¯‘å™¨çš„makeè·¯å¾„ï¼›
  >
  > ![image-20230206155201961](Web.assets/image-20230206155201961.png)
  >
  > ![image-20230206155232023](Web.assets/image-20230206155232023.png)
  >
  > é€‰æ‹©ç¼–è¯‘Releaseæ¨¡å¼->Build->æ·»åŠ Buildæ­¥éª¤->Custom Process Stopï¼Œæ·»åŠ ä¸‹åˆ—ä¿¡æ¯ï¼ŒMSVCç¼–è¯‘å™¨ä½¿ç”¨jom.exeï¼›
  >
  > ![image-20230206155609104](Web.assets/image-20230206155609104.png)

* æ¼”ç¤º

![image-20230206155736344](Web.assets/image-20230206155736344.png)
